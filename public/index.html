<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BlueBubbles Realtor</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Added title back with "AI Home Quote" -->
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-blue-600">AI Home Quote</h1>
        </header>

        <div id="loading" class="text-center py-8 hidden">
            <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
            <p class="mt-4 text-gray-600">Loading information...</p>
        </div>

        <div id="error-message" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mt-4 hidden" role="alert">
            <span class="block sm:inline"></span>
        </div>

        <!-- Card containers - will be populated via JavaScript -->
        <div id="card-container"></div>
    </div>

    <script src="Lo.js"></script>
    <script src="app.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
    <script src="qrCode.js"></script>
    <script>
      // Card loading and display logic
      document.addEventListener("DOMContentLoaded", function(){
        const params = new URLSearchParams(window.location.search);
        const agentParam = params.get("agent");
        const loParam = params.get("lo");
        const cardContainer = document.getElementById("card-container");
        
        // Show loading indicator
        document.getElementById("loading").classList.remove("hidden");
        
        // Load the appropriate card component
        async function loadCardComponent() {
          try {
            // Priority: Agent parameter overrides LO parameter if both exist
            if (agentParam) {
              // If agent parameter exists, always show realtor card regardless of LO parameter
              const response = await fetch('realtorCard.html');
              const html = await response.text();
              cardContainer.innerHTML = html;
              // app.js will handle populating the realtor data
            } 
            // If only LO parameter exists (no agent), show LO card
            else if (loParam) {
              const response = await fetch('LoCard.html');
              const html = await response.text();
              cardContainer.innerHTML = html;
              // Lo.js will handle populating the LO data
            } 
            // Default fallback: show LO card with default profile
            else {
              const response = await fetch('LoCard.html');
              const html = await response.text();
              cardContainer.innerHTML = html;
            }
          } catch (error) {
            console.error("Error loading card component:", error);
            document.getElementById("error-message").textContent = "Failed to load content. Please try again.";
            document.getElementById("error-message").classList.remove("hidden");
          } finally {
            document.getElementById("loading").classList.add("hidden");
          }
        }
        
        loadCardComponent();
      });
    </script>
</body>
</html>
